## Multiple Vulnerability Disclosure on Avast AntiVirus (RPC Service)


**Tested Environment**

OS: Windows 7 Ultimate 32Bit (6.1, Build 7601),  Windows 10 Pro 32Bit (10, Build 18363)
VM: Virtual Box

1. Windows 7 Ultimate 32Bit (6.1, Build 7601):

```
Avast Antivirus Type Avast Free AntiVirus
Avast Antivirus Version: 19.8.2393 (build 19.8.4793.545)
UI Version: 1.0.437
AvastSvc Service Version: 19.8.4793.0
```

2. Windows 10 Pro 32Bit (10, Build 18363)

```
Avast Antivirus Type: Avast Free AntiVirus, Avast Premium Security
Avast Antivirus Version: 19.8.2393 (build 19.8.4257.552)
UI Version: 1.0.409
AvastSvc  Service Version: 19.8.4793.0
```


**CVE-2020-10860: Arbitrary Memory Address Overwrite Vulnerability in the Avast Log Library**

An issue was discovered in Avast Antivirus before 20. An Arbitrary Memory Address Overwrite vulnerability in the aswAvLog Log Library results in Denial of Service of the Avast Service (AvastSvc.exe).

**Demo:**


1. Free Avast Antivirus

    [![Alt text](https://img.youtube.com/vi/I419r0eh6YI/0.jpg)](https://www.youtube.com/watch?v=I419r0eh6YI)

2. Premium Avast Antivirus

    [![Alt text](https://img.youtube.com/vi/-6M1uIxq_I8/0.jpg)](https://www.youtube.com/watch?v=-6M1uIxq_I8)

3. Disable SelfDefense Protection from untrusted application


    [![Alt text](https://img.youtube.com/vi/RIf5F708HZw/0.jpg)](https://www.youtube.com/watch?v=RIf5F708HZw)



**CVE-2020-10861: Arbitrary File Deletion**

An issue was discovered in Avast Antivirus before 20.The aswTask RPC endpoint for the TaskEx library in the Avast Service (AvastSvc.exe) allows attackers to achieve Arbitrary File Deletion from Avast Program Path via RPC, when Self Defense is Enabled


**CVE-2020-10862: Local Privilege Escalation (LPE)**

An issue was discovered in Avast Antivirus before 20. The aswTask RPC endpoint for the TaskEx library in the Avast Service (AvastSvc.exe) allows attackers to achieve Local Privilege Escalation (LPE) via RPC.


**CVE-2020-10863: Execute TempShutDownMachine via RPC**

An issue was discovered in Avast Antivirus before 20. The aswTask RPC endpoint for the TaskEx library in the Avast Service (AvastSvc.exe) allows attackers to trigger a shutdown via RPC from a Low Integrity process via TempShutDownMachine.


**CVE-2020-10864: Execcute Reboot via RPC**

An issue was discovered in Avast Antivirus before 20. The aswTask RPC endpoint for the TaskEx library in the Avast Service (AvastSvc.exe) allows attackers to trigger a reboot via RPC from a Low Integrity process.

**CVE-2020-10865: Arbitary read/write Stats.ini file**

An issue was discovered in Avast Antivirus before 20. The aswTask RPC endpoint for the TaskEx library in the Avast Service (AvastSvc.exe) allows attackers to make arbitrary changes to the Components section of the Stats.ini file via RPC from a Low Integrity process


**CVE-2020-10866: Enumerate Network Interface and access points**

An issue was discovered in Avast Antivirus before 20. The aswTask RPC endpoint for the TaskEx library in the Avast Service (AvastSvc.exe) allows attackers to enumerate the network interfaces and access points from a Low Integrity process via RPC


**CVE-2020-10867: Perform Unauthorized action (task) from untrusted process**

An issue was discovered in Avast Antivirus before 20. The aswTask RPC endpoint for the TaskEx library in the Avast Service (AvastSvc.exe) allows attackers to bypass intended access restrictions on tasks from an untrusted process, when Self Defense is enabled.


**CVE-2020-10868: Launch Repair app via RPC**

An issue was discovered in Avast Antivirus before 20. The aswTask RPC endpoint for the TaskEx library in the Avast Service (AvastSvc.exe) allows attackers to launch the Repair App RPC call from a Low Integrity process.

**Demo**

[![Alt text](https://img.youtube.com/vi/cemPvsp1M_M/0.jpg)](https://www.youtube.com/watch?v=cemPvsp1M_M)


### :octocat:Credits:
* Umar Farook: [OSCE | Senior Security Analyst | Researcher](https://www.linkedin.com/in/Umar-Farook)
* FOS Team : [Fools of Security](https://www.youtube.com/channel/UCEBHO0kD1WFvIhf9wBCU-VQ)


### Support !
  
Email address: umarfarookmech712@gmail.com  or pingus@foolsofsecurity.com <br/>
Youtube: [Fools Of Security](https://www.youtube.com/channel/UCEBHO0kD1WFvIhf9wBCU-VQ)<br/>
Website: [Fools Of Security Community](https://foolsofsecurity.com) <br/>

**Reference:**

[Avast Release Notes](https://forum.avast.com/index.php?topic=232420.0) <br/>
[Free - AvastSvc Service (Arbitrary Memory Address Overwrite DOS)](https://www.youtube.com/watch?v=I419r0eh6YI)<br/>
[Premium - AvastSvc Service (Arbitrary Memory Address Overwrite - DOS)](https://www.youtube.com/watch?v=-6M1uIxq_I8) <br/>
[AvastSvc - Disable SelfDefense Protection from untrusted application](https://www.youtube.com/watch?v=RIf5F708HZw)<br/>
[Local Privilege Escalation](https://www.youtube.com/watch?v=cemPvsp1M_M)


